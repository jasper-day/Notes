<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-0.9.515">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Jasper Day">
<meta name="dcterms.date" content="2022-06-06">

<title>Class Notes - Convolutions</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../../../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../../../">
<script src="../../../../../site_libs/quarto-html/quarto.js"></script>
<script src="../../../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<style>html{ scroll-behavior: smooth; }</style>

  <script>window.backupDefine = window.define; window.define = undefined;</script><script src="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.css">

</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <a class="navbar-brand" href="../../../../../index.html">
    <span class="navbar-title">Class Notes</span>
  </a>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../../../../index.html">Home</a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../../../about.html">About</a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../../..//Class_Notes.html">Class Notes</a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../../../Other_Notes.html">Other Notes</a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#kernels-and-convolutions" id="toc-kernels-and-convolutions" class="nav-link active" data-scroll-target="#kernels-and-convolutions"> <span class="header-section-number">1</span> Kernels and Convolutions</a></li>
  <li><a href="#the-convolution-function" id="toc-the-convolution-function" class="nav-link" data-scroll-target="#the-convolution-function"> <span class="header-section-number">2</span> The Convolution Function</a></li>
  <li><a href="#edge-detection" id="toc-edge-detection" class="nav-link" data-scroll-target="#edge-detection"> <span class="header-section-number">3</span> Edge detection</a></li>
  <li><a href="#polynomial-multiplication" id="toc-polynomial-multiplication" class="nav-link" data-scroll-target="#polynomial-multiplication"> <span class="header-section-number">4</span> Polynomial Multiplication</a></li>
  <li><a href="#takeaways" id="toc-takeaways" class="nav-link" data-scroll-target="#takeaways"> <span class="header-section-number">5</span> Takeaways</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Convolutions</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Jasper Day </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">June 6, 2022</p>
    </div>
  </div>
    
  </div>
  

</header>

<section id="kernels-and-convolutions" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Kernels and Convolutions</h1>
<p>Start with a blur:</p>
<p>For each pixel, take the average of the pixels around it (or a weighted sum of the pixels around it.)</p>
<p>The resulting values are a convolution of two grids (combining two functions to get a new function.) A blur would be a convolution with a <em>gaussian kernel</em>: take a larger image, and replace the value of each pixel with the sum of the values in the kernel times the values of the corresponding surrounding pixels.</p>
<p><span id="eq-gauss"><span class="math display">
K = \begin{bmatrix}
    0.003 &amp; 0.013 &amp; 0.022 &amp; 0.013 &amp; 0.003 \\
    0.013 &amp; 0.060 &amp; 0.098 &amp; 0.060 &amp; 0.013 \\
    0.022 &amp; 0.098 &amp; 0.162 &amp; 0.098 &amp; 0.022 \\
    0.013 &amp; 0.060 &amp; 0.098 &amp; 0.060 &amp; 0.013 \\
    0.003 &amp; 0.013 &amp; 0.022 &amp; 0.013 &amp; 0.003
    \end{bmatrix}
\tag{1}</span></span></p>
<p><a href="#eq-gauss">Equation&nbsp;1</a> shows a sample 5x5 gaussian kernel.</p>
<p>The gaussian is a particularly nice curve to take since the sum of the area under the curve is 1.</p>
<p>Let’s start coding up some examples:</p>
<div class="cell" data-execution_count="1">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Images</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Plots</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Here’s the image we’ll use today.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="https://unsplash.com/photos/yMSecCHsIBc" height="50%"><img src="../../../../../coolcat.jpg" class="img-fluid figure-img"></a></p>
<p></p><figcaption aria-hidden="true" class="figure-caption">Cool cat courtesy of Raoul Droog on Unsplash</figcaption><p></p>
</figure>
</div>
<div class="cell" data-execution_count="2">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">download</span>(<span class="st">"https://unsplash.com/photos/yMSecCHsIBc/download?ixid=MnwxMjA3fDB8MXxzZWFyY2h8NXx8Y2F0fGVufDB8fHx8MTY1NDUxNzk5MA&amp;force=true&amp;w=640"</span>, <span class="st">"./coolcat.jpg"</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>coolcat <span class="op">=</span> <span class="fu">load</span>(<span class="st">"./coolcat.jpg"</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="pp">@show</span> <span class="fu">size</span>(coolcat);</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>size(coolcat) = (853, 640)</code></pre>
</div>
</div>
<p>Now let’s make a gaussian:</p>
<div class="cell" data-execution_count="3">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>kernel <span class="op">=</span> Kernel.<span class="fu">gaussian</span>((<span class="fl">1</span>,<span class="fl">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="4">
<pre><code>5×5 OffsetArray(::Matrix{Float64}, -2:2, -2:2) with eltype Float64 with indices -2:2×-2:2:
 0.00296902  0.0133062  0.0219382  0.0133062  0.00296902
 0.0133062   0.0596343  0.0983203  0.0596343  0.0133062
 0.0219382   0.0983203  0.162103   0.0983203  0.0219382
 0.0133062   0.0596343  0.0983203  0.0596343  0.0133062
 0.00296902  0.0133062  0.0219382  0.0133062  0.00296902</code></pre>
</div>
</div>
<p>“<code>5x5 OffsetArray</code>” means that <code>[0,0]</code> is actually in the center of the array.</p>
<p>Here’s what the kernel looks like at a couple of different sizes:</p>
<div class="cell" data-execution_count="4">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>heatmaps <span class="op">=</span> []</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">6</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>    kerneli <span class="op">=</span> Kernel.<span class="fu">gaussian</span>((i,i))</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>    bounds <span class="op">=</span> <span class="fu">size</span>(kerneli)[<span class="fl">1</span>] <span class="op">÷</span> <span class="fl">2</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>    boundsrange <span class="op">=</span> <span class="op">-</span>bounds<span class="op">:</span>bounds</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">push!</span>(heatmaps, <span class="fu">heatmap</span>(boundsrange,boundsrange,kerneli, legend<span class="op">=</span><span class="cn">false</span>))</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(heatmaps<span class="op">...</span>, layout <span class="op">=</span>(<span class="fl">3</span>,<span class="fl">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="5">
<p><img src="Convolutions_files/figure-html/cell-5-output-1.svg" class="img-fluid"></p>
</div>
</div>
<p>Note that the sum of the kernel is 1, so our image shouldn’t get any lighter or darker under the convolution.</p>
<p>When you convolve the kernel and the image, the kernel “marches across” the image, replacing each value with the elementwise multiplication of the values in the kernel with the corresponding values in the image.</p>
<p>Using a kernel that adds the values around the center to the center gives a blurrier image (averaging the pixels around it with the center pixel). Using a kernel that subtracts the values of the surrounding pixels gives a sharper image.</p>
</section>
<section id="the-convolution-function" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> The Convolution Function</h1>
<p>We need a convolution function. That</p>
</section>
<section id="edge-detection" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Edge detection</h1>
<p>To do edge detection, use a kernel that subtracts the top half from the bottom half, or vice versa.</p>
<div class="cell" data-execution_count="5">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="pp">@show</span> horEdgeKern <span class="op">=</span> Kernel.<span class="fu">sobel</span>()[<span class="fl">1</span>];</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="pp">@show</span> vertEdgeKern <span class="op">=</span> Kernel.<span class="fu">sobel</span>()[<span class="fl">2</span>];</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>horEdgeKern = (Kernel.sobel())[1] = [-0.125 -0.25 -0.125; 0.0 0.0 0.0; 0.125 0.25 0.125]
vertEdgeKern = (Kernel.sobel())[2] = [-0.125 0.0 0.125; -0.25 0.0 0.25; -0.125 0.0 0.125]</code></pre>
</div>
</div>
<p>The horizontal edge detection kernel looks like this:</p>
<p><span class="math display">
K = \begin{bmatrix}
    -0.125 &amp; 0.0 &amp; 0.125 \\
    -0.25 &amp; 0.0 &amp; 0.25 \\
    -0.125 &amp; 0.0 &amp; 0.125 \\
\end{bmatrix}
</span></p>
<p>And the vertical edge detection kernel is the transpose of the horizontal.</p>
<p>When you get values that change above and below the center of the kernel, the edge detection kernels return either a positive or a negative number.</p>
<p>A <em>convolutional neural network</em> uses a machine to learn which kernel it should use to get the desired output.</p>
<p>In the mathematical context, you generally rotate the convolutional kernel 180° before you apply it.</p>
</section>
<section id="polynomial-multiplication" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Polynomial Multiplication</h1>
<p>Consider:</p>
<p><span class="math display">
\left( k_0 + k_1x + k_2x^2\right)\left(a_0 + a_1x + a_2x^2 + a_3x^3 + a_4x^4 \cdots \right)
</span></p>
<p>The constant for the <span class="math inline">x^3</span> term in this expression is</p>
<p><span id="eq-x3"><span class="math display">
k_2a_1 + k_1a_2 + k_0a_3
\tag{2}</span></span></p>
<p>The total multiplication is:</p>
<p><span id="eq-polymul"><span class="math display">
\begin{split}
(k_0a_0)x^0 &amp;+\\
(k_1a_0 + k_0a_1)x^1 &amp;+\\
(k_2a_0 + k_1a_1 + k_0a_2)x^2 &amp;+\\
(k_2a_1 + k_1a_2 + k_0a_3)x^3 &amp;+\\
(k_2a_2 + k_1a_3 + k_0a_4)x^4 &amp;+\\
(k_2a_3 + k_1a_4 + k_0a_5)x^5 &amp;+\\
&amp;\vdots \end{split}
\tag{3}</span></span></p>
<p>You could describe the polynomial multiplication in <a href="#eq-polymul">Equation&nbsp;3</a> as a <em>convolution</em> between the terms of <span class="math inline">\left( k_0 + k_1x + k_2x^2\right)</span> and <span class="math inline">\left(a_0 + a_1x + a_2x^2 + a_3x^3 + a_4x^4 \cdots \right)</span>! But in order for that to work, you first have to rotate the <span class="math inline">k</span> polynomial by 180 degrees, so that <span class="math inline">k_2x^2</span> comes first and <span class="math inline">k_0</span> comes last.</p>
<p>This becomes a convention.</p>
<p>Pixel data isn’t actually stored as a multiple of powers of <span class="math inline">x</span>, but it <em>is</em> common to see pixel data as a fourier transform, in which case you would be multiplying the kernel by</p>
<p><span id="eq-fourier"><span class="math display">
\left(
    a_0
    + a_1\left(e^{2\pi i f}\right)
    + a_2\left(e^{2\pi i f}\right)^2
    + a_3\left(e^{2\pi i f}\right)^3
    + a_4\left(e^{2\pi i f}\right)^4
    + \cdots
\right)
\tag{4}</span></span></p>
<div class="remark proof">
<p><span class="proof-title"><em>Remark</em>. </span>Note about fourier transforms: They’re very analogous to power series, in that we’re multiplying by something we have successive powers of. When we multiply two fourier series, the result corresponds to convolving the original terms of the series.</p>
</div>
<p>So we can take the fourier transforms of our image and our kernel, multiply them together, and detransform. The multiplication of the two fourier transforms is equivalent to convolving by the (rotated) kernel.</p>
</section>
<section id="takeaways" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> Takeaways</h1>
<ul>
<li>A simple tool that seems specific (taking the moving averages of the pixel values in an image) can be split into the general idea (in this case convolution), which opens up a lot more room to play.
<ul>
<li>Blurring, sharpening, edge detecting</li>
</ul></li>
<li>Representing the same data, or the same operations, different ways in different domains can allow you to solve problems much faster.</li>
</ul>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->



<script src="../../../../../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>